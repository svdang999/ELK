####
# helm repo add elastic https://helm.elastic.co
# helm install -f helm/elasticsearch.yml elasticsearch elastic/elasticsearch
####
clusterName: "elasticsearch"
replicas: 1
minimumMasterNodes: 1

esMajorVersion: "7"
image: "docker.elastic.co/elasticsearch/elasticsearch"
imageTag: "7.9.1"
imagePullPolicy: "IfNotPresent"
nodeSelector:
  "kubernetes.io/os": linux
  # "mode": user
resources:
  requests:
    cpu: "500m"
    memory: "2Gi"
  limits:
    cpu: "1"
    memory: "2Gi"
clusterHealthCheckParams: "wait_for_status=yellow&timeout=1s"
extraEnvs:
  - name: ELASTIC_USERNAME
    value: elastic
  - name: ELASTIC_PASSWORD
    value: 4ZiJCLVw4RHHWDUx
esJavaOpts: "-Xmx1g -Xms1g -Dlog4j2.formatMsgNoLookups=true" # default Xmx + adhoc Log4Shell CVE problems
esConfig:
  elasticsearch.yml: |
    xpack.security.enabled: true
    xpack.security.transport.ssl.enabled: true
    xpack.security.transport.ssl.verification_mode: certificate
    xpack.security.transport.ssl.keystore.path: /usr/share/elasticsearch/config/certs/elastic-certificates.p12
    xpack.security.transport.ssl.truststore.path: /usr/share/elasticsearch/config/certs/elastic-certificates.p12

secretMounts:
  - name: elastic-certificates
    secretName: elastic-certificates
    path: /usr/share/elasticsearch/config/certs

volumeClaimTemplate:
  accessModes: [ "ReadWriteOnce" ]
  storageClassName: "default"
  resources:
    requests:
      storage: 30Gi


